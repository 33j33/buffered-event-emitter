!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["buffered-event-emitter"]={})}(this,(function(e){"use strict";class t{constructor(e,t,i){this.fn=e,this.once=t,this.options=i,(null==i?void 0:i.buffered)&&(this.bucket=[],this.timeoutID=void 0)}}function i(e,t){if(!e||!t)return!1;const i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;let s;for(s in e)if(e[s]!==t[s])return!1;return!0}function n(e,t,n){for(let s=0;s<e.length;s++)if(e[s].fn===t&&i(e[s].options,n))return s;return-1}function s(e,t){let i;return new Promise((n=>i=setTimeout((()=>{this.emit(e.eventName,e.data),n(!0)}),t))).finally((()=>{clearTimeout(i)}))}function o(e,t,i){if("emit"===e&&!r.debugStatus.emit||"on"===e&&!r.debugStatus.on||"off"===e&&!r.debugStatus.off)return;if("emit"===e)try{i=JSON.stringify(i)}catch(e){i=`Object with the following keys failed to stringify: ${Object.keys(i).join(",")}`}else["on","off"].includes(e)&&"function"==typeof i&&(i=i.toString());const n=new Date,s=`${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}.${n.getMilliseconds()}`;console.groupCollapsed(`%c[Event Type: ${e} | Event Name: ${t} | ${s}]`,"color: blue; font-size: 12px"),console.log(`%c[Event Data: ${i}}]`,"color: #AD5D4E; font-size: 11px"),console.groupEnd()}var u=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function u(e){try{f(n.next(e))}catch(e){o(e)}}function r(e){try{f(n.throw(e))}catch(e){o(e)}}function f(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(u,r)}f((n=n.apply(e,t||[])).next())}))};class r{constructor(e){var t,i,n;this._events={},this._options={buffered:null!==(t=null==e?void 0:e.buffered)&&void 0!==t&&t,bufferCapacity:null!==(i=null==e?void 0:e.bufferCapacity)&&void 0!==i?i:5,logger:null!==(n=null==e?void 0:e.logger)&&void 0!==n?n:o},this._status="emitting",this._queueEmissions=!0,this._emissionInterval=0,this._queue=[]}emit(e,t){if(!this._events[e]||0===this._events[e].length)return!1;if("paused"===this._status)return this._queueEmissions&&this._queue.push({eventName:e,data:t}),!1;let i=[],n=!1;return this._events[e].forEach((s=>{var o,u;let r=!1;if(s.options.buffered){null===(o=null==s?void 0:s.bucket)||void 0===o||o.push(t);const i=null!==(u=s.options.bufferCapacity)&&void 0!==u?u:this._options.bufferCapacity;(null==s?void 0:s.bucket)&&s.bucket.length>=i&&(s.fn(s.bucket),r=!0,n=!0,this._options.logger("emit",e,s.bucket),s.bucket=[])}else s.fn(t),r=!0,n=!0,this._options.logger("emit",e,t);s.once&&r||i.push(s)})),this._events[e]=i,n}on(e,i,s=this._options){return this._events[e]||(this._events[e]=[]),-1===n(this._events[e],i,s)&&(this._events[e].push(new t(i,!1,s)),this._options.logger("on",e,i),!0)}once(e,i,s=this._options){return this._events[e]||(this._events[e]=[]),-1===n(this._events[e],i,s)&&(this._events[e].push(new t(i,!0,s)),this._options.logger("on",e,i),!0)}off(e,t,i=this._options){let s=n(this._events[e],t,i);return-1!==s&&(this._events[e].splice(s,1),this._options.logger("off",e,t),!0)}flush(e,t,n){let s=!1,o=[];return this._events[e].forEach(((u,r)=>{if(u.options.buffered&&(null==u?void 0:u.bucket)&&u.bucket.length>0){const f=t&&t===u.fn,l=n&&i(n,u.options);(e&&f&&l||e&&!t&&!n)&&(u.fn(u.bucket),s=!0,this._options.logger("emit",e,u.bucket),u.bucket=[],u.once&&o.push(r))}})),this._events[e]=this._events[e].filter(((e,t)=>!o.includes(t))),s}pause(e=!0,t=0){this._queueEmissions=e,this._emissionInterval=t,this._status="paused"}resume(){if(this._status="emitting",this._queueEmissions){if(this._emissionInterval>0){return(()=>u(this,void 0,void 0,(function*(){for(const e of this._queue)yield s.call(this,e,this._emissionInterval)})))()}this._queue.forEach((({eventName:e,data:t})=>{this.emit(e,t)})),this._queue=[]}}offAll(e){var t;return!!(e&&(null===(t=this._events[e])||void 0===t?void 0:t.length)>0)&&(delete this._events[e],this._queue=this._queue.filter((t=>t.eventName!==e)),!0)}cleanup(){this._queue=[],this._events={}}listeners(e){return void 0===e?this._events:this._events[e].map((e=>e.fn))}static enableDebug(e){r.debugStatus=Object.assign(Object.assign({},r.debugStatus),e)}}r.debugStatus={emit:!1,on:!1,off:!1},r.prototype.addListener=r.prototype.on,r.prototype.removeListener=r.prototype.off,e.BufferedEventEmitter=r,Object.defineProperty(e,"__esModule",{value:!0})})),"undefined"!=typeof window&&(window.BufferedEventEmitter=window["buffered-event-emitter"].BufferedEventEmitter);
//# sourceMappingURL=bundle.umd.min.js.map
